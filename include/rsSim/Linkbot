#ifndef RSSIM_LINKBOT_
#define RSSIM_LINKBOT_

#include <rsRobots/Linkbot>
#include <rsSim/ModularRobot>

namespace rsSim {

	// class
	class LIBRSEXPORT Linkbot : virtual public rsRobots::Linkbot, virtual public ModularRobot {
		// public api
		public:
			Linkbot(int);
			virtual ~Linkbot(void);

			virtual int addConnector(int, int, int = rs::Right, double = 0, int = 1, int = -1);
			virtual void calculateTrackwidth(void);
			virtual const rs::Pos getCoM(double&);
			const rs::Vec getJoints(void);
#ifdef RS_RESEARCH
			void moveJointOnce(int, double*);		// research: move from array of values
			void moveJointSingular(int);			// research: move one step at a time
#endif

		// inherited functions from ModularRobot class
		protected:
			virtual int build(const rs::Pos&, const rs::Quat&, const rs::Vec&, dBodyID, int, int, int);

		// inherited functions from Robot class
		protected:
			virtual int build(const rs::Pos&, const rs::Quat&, const rs::Vec&, const rs::Vec&, int);
			virtual void simPreCollisionThread(void);
			virtual void simPostCollisionThread(void);

		// private functions
		private:
			void build_body(const rs::Pos&, const rs::Quat&);
			void build_bridge(Connector&);
			void build_cap(int, const rs::Pos&, const rs::Quat&);
			void build_caster(Connector&, int);
			void build_cube(Connector&);
			void build_doublebridge(Connector&);
			void build_el(Connector&);
			void build_faceplate(Connector&);
			void build_foot(Connector&);
			void build_gripper(Connector&, int);
			void build_omnidrive(Connector&);
			void build_robot(const rs::Pos&, const rs::Quat&, const rs::Vec&);
			void build_simple(Connector&);
			void build_wheel(Connector&, double);
			double calculate_angle(int);

#ifdef RS_RESEARCH
		// private variables
		private:
			std::vector<double *> _values;		// research: values of integrated array
			int _loc[3];						// research: location in array
#endif
	};

} // namespace rsSim

#endif // RSSIM_LINKBOT_

